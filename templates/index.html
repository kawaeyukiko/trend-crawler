<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>多平台趋势图抓取工具</title>
</head>
<body>
  <h2>多平台趋势图抓取工具</h2>
  <form id="searchForm">
    <label>关键词：<input type="text" name="q" required /></label>
    <label>
      来源平台：
      <select name="platform">
        <option value="test">测试平台</option>
        <option value="pinterest">Pinterest</option>
        <option value="bing">Bing</option>
        <!-- 可继续添加其他平台 -->
      </select>
    </label>
    <button type="submit">开始搜索</button>
  </form>

  <hr />
  <div id="results"></div>

  <script>
    const form = document.getElementById('searchForm');
    const results = document.getElementById('results');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      results.innerHTML = '加载中...';

      const formData = new FormData(form);
      const query = formData.get('q');
      const platform = formData.get('platform');

      try {
        const res = await fetch(`/search?q=${encodeURIComponent(query)}&platform=${platform}`);
        const data = await res.json();

        if (data.results && data.results.length) {
          results.innerHTML = '';
          data.results.forEach(img => {
            const el = document.createElement('img');
            el.src = img.url;
            el.alt = img.source;
            el.style = "max-width: 200px; margin: 5px;";
            results.appendChild(el);
          });
        } else {
          results.innerHTML = '没有找到图片。';
        }
      } catch (err) {
        results.innerHTML = '出错了：' + err.message;
      }
    });
  </script>
</body>
</html>
